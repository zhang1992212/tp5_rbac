<div class="cl pd-5 bg-1 bk-gray mt-20">
    <span class="l">
        <a href="javascript:;" onclick="common_add('添加角色','role_add','800','500')" class="btn btn-primary radius">
            <i class="Hui-iconfont">&#xe600;</i> 添加角色</a>
    </span>
    <span class="r">共有数据：<strong><?php echo count($list); ?></strong> 条</span>
</div>
<table class="table table-border table-bordered table-bg  table-sort">
    <thead>
    <tr>
        <th scope="col" colspan="200">角色管理</th>
    </tr>
    <tr class="text-c">
        <th width="25"><input type="checkbox" name="" value=""></th>
        <th width="40">ID</th>
        <th >角色名</th>
        <th width="50">类型</th>
        <th>创建时间</th>
        <th>更新时间</th>
        <th>操作</th>
    </tr>
    </thead>
    <tbody>
    {empty name='list'}
    <td colspan="200" style="text-align: center">暂无数据</td>
    {else/}
    {volist name='list' id='item'}
    <tr class="text-c">
        <td><input type="checkbox" value="1" name=""></td>
        <td>{$item.id}</td>
        <td style="text-align: left">{$item.name}</td>
        <td>
            {if condition="$item['type'] eq 0"}
            系统角色
            {else/}
            普通角色
            {/if}
        </td>
        <td>{$item.create_time}</td>
        <td>{$item.update_time}</td>
        <td>
            <a href="javascript:;" onclick="common_view('查看权限','role_view?id={$item.id}','900','500')" class="btn btn-secondary radius">查看权限</a>
            {if condition="$item['type'] neq 0"}
                <!--删除-->
                <a href="javascript:;" onclick="common_edit('编辑','role_edit?id={$item.id}','800','500')" class="btn btn-warning radius">编辑</a>
                <!--删除-->
                <a href="javascript:;" onclick="common_del(this,'{$item.id}')" class="btn btn-danger radius">删除</a>
            {/if}
        </td>
    </tr>
    {/volist}
    {/empty}
    </tbody>
</table>
<script>
    /* 增加 */
    function common_add(title,url,w,h){
        layer_show(title,url,w,h);
    }

    /* 删除 */
    function common_del(obj,id){
        layer.confirm('确认要删除吗？',function(index){
            //此处请求后台程序，下方是成功后的前台处理……
            $.ajax({
                url:"role_del",    //请求的url地址
                dataType:"json",   //返回格式为json
                async:true,//请求是否异步，默认为异步，这也是ajax重要特性
                data:{"id":id},    //参数值
                type:"POST",   //请求方式
                beforeSend:function(){
                    //请求前的处理
                    index = layer.load();
                },
                success:function(req){
                    $(obj).parents("tr").remove();
                    layer.msg('已删除!',{icon:1,time:1000});
                },
                complete:function(){
                    //请求完成的处理
                    layer.close(index);
                },
                error:function(req){
                    //请求出错处理
                    layer.msg(JSON.parse(req.responseText).msg,{icon:2,time:3000});
                }
            });
        });
    }

    /*管理员-编辑*/
    function common_edit(title,url,id,w,h){
        layer_show(title,url,w,h);
    }

    /*管理员-查看*/
    function common_view(title,url,id,w,h){
        layer_show(title,url,w,h);
    }

    $('.table-sort').dataTable({
        "aaSorting": [[ 1, "desc" ]],//默认第几个排序
        "bStateSave": true,//状态保存
        "aoColumnDefs": [
            //{"bVisible": false, "aTargets": [ 3 ]} //控制列的隐藏显示
            {"orderable":false,"aTargets":[0,6]}// 制定列不参与排序
        ]
    });


</script>